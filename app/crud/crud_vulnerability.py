from sqlalchemy.orm import Session
from app.models.vulnerability import Vulnerability
from app.schemas.vulnerability import VulnerabilityCreate

def get_vulnerabilities(db: Session, project_id: int):
    return db.query(Vulnerability).filter(Vulnerability.project_id == project_id).all()

def create_vulnerability(db: Session, vulnerability: VulnerabilityCreate, project_id: int):
    db_vulnerability = Vulnerability(**vulnerability.dict(), project_id=project_id)
    db.add(db_vulnerability)
    db.commit()
    db.refresh(db_vulnerability)
    return db_vulnerability